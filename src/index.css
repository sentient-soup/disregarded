@import "tailwindcss";

/* Everforest Dark Medium Color Palette */
@theme {
  /* Background colors */
  --color-bg-dim: #232A2E;
  --color-bg0: #2D353B;
  --color-bg1: #343F44;
  --color-bg2: #3D484D;
  --color-bg3: #475258;
  --color-bg4: #4F585E;
  --color-bg5: #56635f;
  
  /* Special backgrounds */
  --color-bg-visual: #543A48;
  --color-bg-red: #514045;
  --color-bg-yellow: #4D4C43;
  --color-bg-green: #425047;
  --color-bg-blue: #3A515D;
  --color-bg-purple: #4A444E;
  
  /* Foreground colors */
  --color-fg: #D3C6AA;
  --color-red: #E67E80;
  --color-orange: #E69875;
  --color-yellow: #DBBC7F;
  --color-green: #A7C080;
  --color-aqua: #83C092;
  --color-blue: #7FBBB3;
  --color-purple: #D699B6;
  
  /* Grey scale */
  --color-grey0: #7A8478;
  --color-grey1: #859289;
  --color-grey2: #9DA9A0;
}

@layer base {
  :root {
    font-family: "JetBrains Mono", "Fira Code", "SF Mono", "Cascadia Code", monospace;
    color: var(--color-fg);
    background-color: var(--color-bg-dim);
  }

  html, body, #root {
    @apply min-h-screen m-0 p-0;
    background-color: var(--color-bg-dim);
  }

  body {
    display: flex;
    flex-direction: column;
  }

  #root {
    display: flex;
    flex-direction: column;
    flex: 1;
  }

  /* Custom scrollbar for terminal feel */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: var(--color-bg0);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--color-bg3);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--color-bg4);
  }

  /* Selection styling */
  ::selection {
    background: var(--color-bg-visual);
    color: var(--color-fg);
  }
}

@layer components {
  /* Main app container - full screen centered */
  .app-container {
    @apply flex flex-col min-h-screen;
    background-color: var(--color-bg-dim);
  }

  /* Terminal main area */
  .terminal-main {
    @apply flex-1 flex flex-col items-center justify-center px-4;
  }

  /* Logo styling */
  .logo-container {
    @apply mb-12 text-center;
  }

  .logo-text {
    color: var(--color-grey1);
    font-size: 1rem;
    line-height: 1.3;
    letter-spacing: 0.1em;
    user-select: none;
    white-space: pre;
  }

  /* Scale down logo on small screens to prevent cutoff */
  @media (max-width: 480px) {
    .logo-container {
      transform: scale(0.6);
      transform-origin: center;
    }
  }

  @media (min-width: 481px) and (max-width: 639px) {
    .logo-container {
      transform: scale(0.8);
      transform-origin: center;
    }
  }

  @media (min-width: 640px) {
    .logo-text {
      font-size: 1.25rem;
    }
  }

  @media (min-width: 768px) {
    .logo-text {
      font-size: 1.5rem;
    }
  }

  /* Input box container */
  .input-box {
    @apply w-full max-w-2xl;
  }

  /* Terminal box - contains output and input */
  .terminal-box {
    background: var(--color-bg0);
    border-left: 3px solid var(--color-aqua);
    border-radius: 0;
    min-height: 200px;
    max-height: 400px;
    display: flex;
    flex-direction: column;
  }

  .terminal-output-area {
    @apply flex-1 overflow-y-auto p-4;
    min-height: 150px;
  }

  .terminal-input-line {
    @apply flex items-center gap-2 px-4 py-3;
    border-top: 1px solid var(--color-bg2);
  }

  .terminal-prompt {
    color: var(--color-aqua);
    font-weight: 600;
  }

  .terminal-input {
    @apply flex-1;
    background: transparent;
    border: none;
    outline: none;
    color: var(--color-fg);
    font-family: inherit;
    font-size: 1rem;
    caret-color: var(--color-aqua);
  }

  .terminal-input::placeholder {
    color: var(--color-grey0);
  }

  .terminal-input:disabled {
    opacity: 0.7;
  }

  /* Status line below input */
  .status-line {
    @apply flex items-center gap-4 px-4 py-2 text-sm;
    background: var(--color-bg1);
    border-left: 3px solid var(--color-aqua);
    border-radius: 0;
    margin-top: -1px;
  }

  .status-label {
    color: var(--color-aqua);
    font-weight: 500;
  }

  .status-value {
    color: var(--color-fg);
  }

  .status-muted {
    color: var(--color-grey0);
  }

  /* Hints bar */
  .hints-bar {
    @apply flex items-center justify-center gap-6 mt-4 text-sm;
    color: var(--color-grey0);
  }

  .hint-item {
    @apply flex items-center gap-2;
  }

  .hint-key {
    color: var(--color-grey1);
    font-weight: 500;
  }

  .hint-label {
    color: var(--color-grey0);
  }

  /* Output line */
  .output-line {
    @apply py-0.5;
    color: var(--color-fg);
    line-height: 1.5;
  }

  /* Tip section at bottom */
  .tip-section {
    @apply flex items-center justify-center gap-2 mt-8 text-sm;
  }

  .tip-dot {
    @apply w-2 h-2 rounded-full;
    background: var(--color-yellow);
  }

  .tip-label {
    color: var(--color-yellow);
    font-weight: 500;
  }

  .tip-text {
    color: var(--color-grey0);
  }

  .tip-key {
    color: var(--color-aqua);
  }

  /* Footer status bar */
  .footer-bar {
    @apply flex items-center justify-between px-4 py-2 text-sm;
    color: var(--color-grey0);
  }

  /* Text colors */
  .text-success { color: var(--color-green); }
  .text-error { color: var(--color-red); }
  .text-warning { color: var(--color-yellow); }
  .text-info { color: var(--color-blue); }
  .text-muted { color: var(--color-grey0); }
  .text-accent { color: var(--color-aqua); }
  .text-highlight { color: var(--color-orange); }
  .text-special { color: var(--color-purple); }

  /* Essay list styling */
  .essay-item {
    @apply py-2;
  }

  .essay-id {
    color: var(--color-grey0);
  }

  .essay-status {
    font-weight: 500;
  }

  .essay-status-draft {
    color: var(--color-yellow);
  }

  .essay-status-published {
    color: var(--color-green);
  }

  .essay-title {
    color: var(--color-aqua);
  }

  .essay-author {
    color: var(--color-purple);
  }

  /* Editor styles - Vim-like */
  .editor-container {
    @apply fixed inset-0 z-50;
    background: var(--color-bg-dim);
    display: flex;
    flex-direction: column;
  }

  .editor-main {
    @apply flex-1 flex overflow-hidden;
    min-height: 0;
  }

  /* CodeMirror wrapper */
  .editor-codemirror-wrapper {
    flex: 1;
    max-width: 900px;
    margin: 0 auto;
    width: 100%;
    min-height: 0;
    display: flex;
    flex-direction: column;
  }

  .editor-codemirror-wrapper > div {
    flex: 1;
    min-height: 0;
  }

  .editor-codemirror-wrapper .cm-editor {
    height: 100% !important;
    font-size: 0.875rem;
  }

  .editor-codemirror-wrapper .cm-editor.cm-focused {
    outline: none;
  }

  .editor-codemirror-wrapper .cm-scroller {
    overflow: auto !important;
    overscroll-behavior: none;
  }

  .editor-codemirror-wrapper .cm-gutters {
    padding-right: 8px;
  }

  /* Preview mode */
  .editor-preview-full {
    @apply flex-1 overflow-auto flex justify-center;
  }

  .editor-preview-content {
    @apply p-8;
    max-width: 700px;
    width: 100%;
  }

  /* Footer - Vim style */
  .editor-footer {
    background: var(--color-bg0);
    border-top: 1px solid var(--color-bg2);
  }

  .editor-status-line {
    @apply flex items-center justify-between px-4 py-1;
    min-height: 1.75rem;
  }

  .editor-status-left {
    @apply flex items-center gap-2;
  }

  .editor-status-right {
    color: var(--color-grey0);
    font-size: 0.875rem;
  }

  .editor-mode-indicator {
    color: var(--color-yellow);
    font-weight: 500;
    font-size: 0.75rem;
  }

  .editor-title-display {
    color: var(--color-fg);
    font-weight: 500;
  }

  .editor-status-badge {
    font-size: 0.75rem;
    font-weight: 500;
  }

  .editor-status-badge.published {
    color: var(--color-green);
  }

  .editor-status-badge.draft {
    color: var(--color-yellow);
  }

  .editor-status-message {
    color: var(--color-grey1);
  }

  /* Command line */
  .editor-command-line {
    @apply flex items-center px-4 py-1;
  }

  .editor-command-prompt {
    color: var(--color-fg);
    font-weight: 600;
  }

  .editor-command-input {
    @apply flex-1 bg-transparent border-none outline-none ml-1;
    color: var(--color-fg);
    font-family: inherit;
    font-size: inherit;
  }

  /* Prompt line */
  .editor-prompt-line {
    @apply flex items-center px-4 py-1;
  }

  .editor-prompt-message {
    color: var(--color-yellow);
    font-weight: 500;
  }

  .editor-prompt-input {
    @apply flex-1 bg-transparent border-none outline-none;
    color: var(--color-fg);
    font-family: inherit;
    font-size: inherit;
  }

  /* Info bar */
  .editor-info-bar {
    @apply flex items-center justify-between px-4 py-1 text-sm;
    background: var(--color-bg1);
    color: var(--color-grey0);
  }

  /* Touch action bar - only shown on touch devices */
  .editor-touch-actions {
    display: none;
  }

  @media (pointer: coarse) {
    .editor-status-message {
      display: none;
    }

    .editor-touch-actions {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .editor-touch-btn {
      background: var(--color-bg2);
      color: var(--color-fg);
      border: none;
      border-radius: 4px;
      padding: 0.375rem 0.75rem;
      font-family: inherit;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s;
    }

    .editor-touch-btn:hover,
    .editor-touch-btn:active {
      background: var(--color-bg3);
    }

    .editor-touch-btn.primary {
      background: var(--color-bg-blue);
      color: var(--color-blue);
    }

    .editor-touch-btn.primary:hover,
    .editor-touch-btn.primary:active {
      background: var(--color-blue);
      color: var(--color-bg0);
    }

    .editor-touch-btn.success {
      color: var(--color-green);
    }

    .editor-touch-btn.warning {
      color: var(--color-yellow);
    }

    .editor-touch-btn.danger {
      color: var(--color-red);
    }
  }

  /* Markdown preview styles */
  .markdown-preview {
    color: var(--color-fg);
    line-height: 1.8;
  }

  .markdown-preview h1 {
    color: var(--color-green);
    font-size: 1.75rem;
    font-weight: 700;
    margin: 1.5rem 0 1rem;
    border-bottom: 1px solid var(--color-bg3);
    padding-bottom: 0.5rem;
  }

  .markdown-preview h2 {
    color: var(--color-aqua);
    font-size: 1.5rem;
    font-weight: 600;
    margin: 1.25rem 0 0.75rem;
  }

  .markdown-preview h3 {
    color: var(--color-blue);
    font-size: 1.25rem;
    font-weight: 600;
    margin: 1rem 0 0.5rem;
  }

  .markdown-preview h4,
  .markdown-preview h5,
  .markdown-preview h6 {
    color: var(--color-yellow);
    font-weight: 600;
    margin: 0.75rem 0 0.5rem;
  }

  .markdown-preview p {
    margin: 0.75rem 0;
  }

  .markdown-preview a {
    color: var(--color-aqua);
    text-decoration: underline;
  }

  .markdown-preview a:hover {
    color: var(--color-green);
  }

  .markdown-preview strong {
    color: var(--color-orange);
    font-weight: 600;
  }

  .markdown-preview em {
    color: var(--color-purple);
    font-style: italic;
  }

  .markdown-preview code {
    background: var(--color-bg2);
    padding: 0.125rem 0.375rem;
    border-radius: 4px;
    font-size: 0.9em;
    color: var(--color-yellow);
  }

  .markdown-preview pre {
    background: var(--color-bg1);
    border: 1px solid var(--color-bg3);
    border-radius: 6px;
    padding: 1rem;
    overflow-x: auto;
    margin: 1rem 0;
  }

  .markdown-preview pre code {
    background: transparent;
    padding: 0;
    color: var(--color-fg);
  }

  .markdown-preview blockquote {
    border-left: 3px solid var(--color-green);
    padding-left: 1rem;
    margin: 1rem 0;
    color: var(--color-grey2);
    font-style: italic;
  }

  .markdown-preview ul,
  .markdown-preview ol {
    margin: 0.75rem 0;
    padding-left: 1.5rem;
  }

  .markdown-preview li {
    margin: 0.25rem 0;
  }

  .markdown-preview ul li::marker {
    color: var(--color-green);
  }

  .markdown-preview ol li::marker {
    color: var(--color-aqua);
  }

  .markdown-preview hr {
    border: none;
    border-top: 1px solid var(--color-bg3);
    margin: 1.5rem 0;
  }

  .markdown-preview img {
    max-width: 100%;
    border-radius: 4px;
  }

  .markdown-preview table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
  }

  .markdown-preview th,
  .markdown-preview td {
    border: 1px solid var(--color-bg3);
    padding: 0.5rem 0.75rem;
    text-align: left;
  }

  .markdown-preview th {
    background: var(--color-bg1);
    color: var(--color-aqua);
    font-weight: 600;
  }

  /* GitHub-style Alerts */
  .markdown-preview .markdown-alert {
    padding: 0.75rem 1rem;
    margin: 1rem 0;
    border-left: 4px solid;
    border-radius: 0 4px 4px 0;
    background: var(--color-bg0);
  }

  .markdown-preview .markdown-alert-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  .markdown-preview .markdown-alert-title svg {
    width: 1rem;
    height: 1rem;
  }

  .markdown-preview .markdown-alert p {
    margin: 0.25rem 0;
  }

  .markdown-preview .markdown-alert p:first-of-type {
    margin-top: 0;
  }

  .markdown-preview .markdown-alert-note {
    border-left-color: var(--color-blue);
  }

  .markdown-preview .markdown-alert-note .markdown-alert-title {
    color: var(--color-blue);
  }

  .markdown-preview .markdown-alert-tip {
    border-left-color: var(--color-green);
  }

  .markdown-preview .markdown-alert-tip .markdown-alert-title {
    color: var(--color-green);
  }

  .markdown-preview .markdown-alert-important {
    border-left-color: var(--color-purple);
  }

  .markdown-preview .markdown-alert-important .markdown-alert-title {
    color: var(--color-purple);
  }

  .markdown-preview .markdown-alert-warning {
    border-left-color: var(--color-yellow);
  }

  .markdown-preview .markdown-alert-warning .markdown-alert-title {
    color: var(--color-yellow);
  }

  .markdown-preview .markdown-alert-caution {
    border-left-color: var(--color-red);
  }

  .markdown-preview .markdown-alert-caution .markdown-alert-title {
    color: var(--color-red);
  }

  /* Loading spinner */
  .spinner {
    @apply inline-block w-4 h-4 border-2 rounded-full;
    border-color: var(--color-aqua) transparent transparent transparent;
    animation: spin 0.8s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Fade in animation */
  .fade-in {
    animation: fadeIn 0.2s ease-in-out;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  /* Cursor blink */
  .cursor-blink::after {
    content: "â–ˆ";
    animation: blink 1s step-end infinite;
    color: var(--color-aqua);
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
  }

  /* Spell check - red squiggly underline */
  .cm-lintRange-warning {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='3'%3E%3Cpath d='M0 3 L2 1 L4 3 L6 1' stroke='%23E67E80' fill='none' stroke-width='1'/%3E%3C/svg%3E");
    background-repeat: repeat-x;
    background-position: bottom;
    background-size: 6px 3px;
    padding-bottom: 2px;
  }

  /* Hide the default lint gutter markers */
  .cm-lint-marker-warning {
    display: none;
  }

  /* Style the lint gutter */
  .cm-gutter-lint {
    width: 0;
  }

  /* Lint tooltip styling */
  .cm-tooltip-lint {
    background: var(--color-bg1) !important;
    border: 1px solid var(--color-bg3) !important;
    border-radius: 4px !important;
    padding: 4px 8px !important;
    font-size: 0.8rem !important;
    color: var(--color-fg) !important;
    max-width: 300px;
  }

  .cm-diagnostic-warning {
    border: none !important;
    padding: 0 !important;
    color: var(--color-fg) !important;
  }

  .cm-diagnostic-warning::before {
    content: none !important;
  }

  /* Dictionary popup */
  .dictionary-popup {
    position: fixed;
    z-index: 100;
    background: var(--color-bg0);
    border: 1px solid var(--color-bg3);
    border-radius: 4px;
    min-width: 280px;
    max-width: 400px;
    max-height: 350px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    display: flex;
    flex-direction: column;
  }

  .dictionary-popup-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 12px;
    background: var(--color-bg1);
    border-bottom: 1px solid var(--color-bg2);
  }

  .dictionary-popup-word {
    font-weight: 600;
    color: var(--color-aqua);
    font-size: 1rem;
  }

  .dictionary-popup-phonetic {
    color: var(--color-grey1);
    font-size: 0.875rem;
    font-style: italic;
  }

  .dictionary-popup-audio-btn {
    background: transparent;
    border: none;
    color: var(--color-blue);
    cursor: pointer;
    padding: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    transition: background 0.15s;
  }

  .dictionary-popup-audio-btn:hover {
    background: var(--color-bg2);
    color: var(--color-aqua);
  }

  .dictionary-popup-close {
    margin-left: auto;
    background: transparent;
    border: none;
    color: var(--color-grey0);
    cursor: pointer;
    font-size: 1rem;
    padding: 2px 6px;
    border-radius: 4px;
    line-height: 1;
  }

  .dictionary-popup-close:hover {
    background: var(--color-bg2);
    color: var(--color-red);
  }

  .dictionary-popup-content {
    padding: 10px 12px;
    overflow-y: auto;
    flex: 1;
  }

  .dictionary-popup-loading,
  .dictionary-popup-error {
    color: var(--color-grey1);
    font-size: 0.875rem;
    text-align: center;
    padding: 8px 0;
  }

  .dictionary-popup-error {
    color: var(--color-red);
  }

  .dictionary-popup-meanings {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .dictionary-popup-meaning {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .dictionary-popup-pos {
    color: var(--color-purple);
    font-weight: 500;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .dictionary-popup-definitions {
    margin: 0;
    padding-left: 16px;
    color: var(--color-fg);
    font-size: 0.85rem;
    line-height: 1.5;
  }

  .dictionary-popup-definition {
    margin-bottom: 6px;
  }

  .dictionary-popup-definition::marker {
    color: var(--color-grey0);
  }

  .dictionary-popup-example {
    color: var(--color-grey1);
    font-style: italic;
    font-size: 0.8rem;
    margin-top: 2px;
  }
}
